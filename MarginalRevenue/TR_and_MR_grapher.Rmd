---
title: "R Notebook"
output: html_notebook
---

This is an [R Markdown](http://rmarkdown.rstudio.com) Notebook. When you execute code within the notebook, the results appear beneath the code. 

Try executing this chunk by clicking the *Run* button within the chunk or by placing your cursor inside it and pressing *Cmd+Shift+Enter*. 

```{r}
a <- 100
b <- 2

inv_demand <- function(q) a-b*q
demand <- function(p) (a-p)/b
TR <- function(q) inv_demand(q)*q
MR <- function(q) a-2*b*q

max_p <- a
max_q <- demand(0)

input_q <- max_q/4

show_q <- TRUE
show_TR <- TRUE
show_MR <- TRUE
```

Make a plot

```{r}
plot(0:max_q, inv_demand((0:max_q)), axes = FALSE,
     type = "l", lwd = 3,
     yaxs = "i", xaxs = "i",
     xlab = "quantity",
     ylab = "price",
     main = "Demand")
axis(1); axis(2, las = 1)

if(show_TR) {
  polygon(c(0, input_q, input_q, 0),
        c(0, 0, inv_demand(input_q), inv_demand(input_q)),
        col = rgb(0, 0, 1, alpha = .15),
        border = FALSE)
}

if(show_q) {
  points(input_q, inv_demand(input_q), 
       pch = 16, col = "red")
  lines(c(input_q, input_q, 0),
        c(0, inv_demand(input_q), inv_demand(input_q)),
        lty = 3)
}

if(show_MR) {
  lines(c(input_q-1, input_q-1, 0),
        c(0, inv_demand(input_q-1), inv_demand(input_q-1)),
        lty = 2)
  abline(a, -2*b)
  text(input_q, MR(input_q), 
     paste("MR =", round(MR(input_q))),
     pos = 4)
}

```

```{r}
plot(0:max_q, TR(0:max_q), 
     axes = FALSE,
     type = "l", lwd = 3,
     yaxs = "i", xaxs = "i",
     xlab = "quantity",
     ylab = "$",
     main = "Total Revenue")
axis(1); axis(2, las = 1)

if(show_q) {
  points(input_q, TR(input_q), 
       pch = 16, col = "blue")
  lines(c(input_q, input_q),
      c(0, TR(input_q)),
      col = "blue", lty = 2
      )
  arrows(input_q, TR(input_q), 0, TR(input_q),
       length = .1, lty = 2,
       col = "blue")
}

if(show_MR) {
  lines(c(input_q-1, 0),
      c(TR(input_q-1), TR(input_q-1)),
      col = "grey80", lty = 2
      )
  text(input_q, TR(input_q), 
     paste("MR =", round(MR(input_q))),
     pos = 4)
  arrows(input_q-1, TR(input_q-1), 
       input_q-1, y1 = TR(input_q),
       length = .05)
  arrows(input_q-1, TR(input_q-1), 
       input_q, TR(input_q-1),
       length = .05)
}
```

